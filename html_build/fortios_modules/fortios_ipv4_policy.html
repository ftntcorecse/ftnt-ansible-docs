

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fortios_ipv4_policy &mdash; Fortinet Ansible Modules 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fortios_log.disk_filter" href="fortios_log.disk_filter.html" />
    <link rel="prev" title="fortios_ips_settings" href="fortios_ips_settings.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Fortinet Ansible Modules
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fmgr_root.html">FortiManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faz_root.html">FortiAnalyzer</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../fortios_root.html">FortiGate (FortiOS)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../fortios_getting_started.html">TBA</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../fortios_modules.html">Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fortios_address.html">fortios_address</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_alertemail_setting.html">fortios_alertemail_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_antivirus_heuristic.html">fortios_antivirus_heuristic</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_antivirus_profile.html">fortios_antivirus_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_antivirus_quarantine.html">fortios_antivirus_quarantine</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_antivirus_settings.html">fortios_antivirus_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_application_custom.html">fortios_application_custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_application_group.html">fortios_application_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_application_list.html">fortios_application_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_application_name.html">fortios_application_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_application_rule_settings.html">fortios_application_rule_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_authentication_rule.html">fortios_authentication_rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_authentication_scheme.html">fortios_authentication_scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_authentication_setting.html">fortios_authentication_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_certificate_ca.html">fortios_certificate_ca</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_certificate_crl.html">fortios_certificate_crl</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_certificate_local.html">fortios_certificate_local</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_config.html">fortios_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_dlp_filepattern.html">fortios_dlp_filepattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_dlp_fp_doc_source.html">fortios_dlp_fp_doc_source</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_dlp_fp_sensitivity.html">fortios_dlp_fp_sensitivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_dlp_sensor.html">fortios_dlp_sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_dlp_settings.html">fortios_dlp_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_dnsfilter_domain_filter.html">fortios_dnsfilter_domain_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_dnsfilter_profile.html">fortios_dnsfilter_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_endpoint_control_client.html">fortios_endpoint_control_client</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_endpoint_control_forticlient_ems.html">fortios_endpoint_control_forticlient_ems</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_endpoint_control_forticlient_registration_sync.html">fortios_endpoint_control_forticlient_registration_sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_endpoint_control_profile.html">fortios_endpoint_control_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_endpoint_control_registered_forticlient.html">fortios_endpoint_control_registered_forticlient</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_endpoint_control_settings.html">fortios_endpoint_control_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_extender_controller_extender.html">fortios_extender_controller_extender</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.ipmacbinding_setting.html">fortios_firewall.ipmacbinding_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.ipmacbinding_table.html">fortios_firewall.ipmacbinding_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.schedule_group.html">fortios_firewall.schedule_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.schedule_onetime.html">fortios_firewall.schedule_onetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.schedule_recurring.html">fortios_firewall.schedule_recurring</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.service_category.html">fortios_firewall.service_category</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.service_custom.html">fortios_firewall.service_custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.service_group.html">fortios_firewall.service_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.shaper_per_ip_shaper.html">fortios_firewall.shaper_per_ip_shaper</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.shaper_traffic_shaper.html">fortios_firewall.shaper_traffic_shaper</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.ssh_host_key.html">fortios_firewall.ssh_host_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.ssh_local_ca.html">fortios_firewall.ssh_local_ca</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.ssh_local_key.html">fortios_firewall.ssh_local_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.ssh_setting.html">fortios_firewall.ssh_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.ssl_setting.html">fortios_firewall.ssl_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.wildcard_fqdn_custom.html">fortios_firewall.wildcard_fqdn_custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall.wildcard_fqdn_group.html">fortios_firewall.wildcard_fqdn_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_DoS_policy.html">fortios_firewall_DoS_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_DoS_policy6.html">fortios_firewall_DoS_policy6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_address.html">fortios_firewall_address</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_address6.html">fortios_firewall_address6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_address6_template.html">fortios_firewall_address6_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_addrgrp.html">fortios_firewall_addrgrp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_addrgrp6.html">fortios_firewall_addrgrp6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_auth_portal.html">fortios_firewall_auth_portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_central_snat_map.html">fortios_firewall_central_snat_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_dnstranslation.html">fortios_firewall_dnstranslation</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_identity_based_route.html">fortios_firewall_identity_based_route</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_interface_policy.html">fortios_firewall_interface_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_interface_policy6.html">fortios_firewall_interface_policy6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_internet_service.html">fortios_firewall_internet_service</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_internet_service_custom.html">fortios_firewall_internet_service_custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_internet_service_custom_group.html">fortios_firewall_internet_service_custom_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_internet_service_group.html">fortios_firewall_internet_service_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ip_translation.html">fortios_firewall_ip_translation</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ipmacbinding_setting.html">fortios_firewall_ipmacbinding_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ipmacbinding_table.html">fortios_firewall_ipmacbinding_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ippool.html">fortios_firewall_ippool</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ippool6.html">fortios_firewall_ippool6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ipv6_eh_filter.html">fortios_firewall_ipv6_eh_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ldb_monitor.html">fortios_firewall_ldb_monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_local_in_policy.html">fortios_firewall_local_in_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_local_in_policy6.html">fortios_firewall_local_in_policy6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_multicast_address.html">fortios_firewall_multicast_address</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_multicast_address6.html">fortios_firewall_multicast_address6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_multicast_policy.html">fortios_firewall_multicast_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_multicast_policy6.html">fortios_firewall_multicast_policy6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_policy.html">fortios_firewall_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_policy46.html">fortios_firewall_policy46</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_policy6.html">fortios_firewall_policy6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_policy64.html">fortios_firewall_policy64</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_profile_group.html">fortios_firewall_profile_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_profile_protocol_options.html">fortios_firewall_profile_protocol_options</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_proxy_address.html">fortios_firewall_proxy_address</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_proxy_addrgrp.html">fortios_firewall_proxy_addrgrp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_proxy_policy.html">fortios_firewall_proxy_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_schedule_group.html">fortios_firewall_schedule_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_schedule_onetime.html">fortios_firewall_schedule_onetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_schedule_recurring.html">fortios_firewall_schedule_recurring</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_service_category.html">fortios_firewall_service_category</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_service_custom.html">fortios_firewall_service_custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_service_group.html">fortios_firewall_service_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_shaper_per_ip_shaper.html">fortios_firewall_shaper_per_ip_shaper</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_shaper_traffic_shaper.html">fortios_firewall_shaper_traffic_shaper</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_shaping_policy.html">fortios_firewall_shaping_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_shaping_profile.html">fortios_firewall_shaping_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_sniffer.html">fortios_firewall_sniffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ssh_host_key.html">fortios_firewall_ssh_host_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ssh_local_ca.html">fortios_firewall_ssh_local_ca</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ssh_local_key.html">fortios_firewall_ssh_local_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ssh_setting.html">fortios_firewall_ssh_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ssl_server.html">fortios_firewall_ssl_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ssl_setting.html">fortios_firewall_ssl_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ssl_ssh_profile.html">fortios_firewall_ssl_ssh_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_ttl_policy.html">fortios_firewall_ttl_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vip.html">fortios_firewall_vip</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vip46.html">fortios_firewall_vip46</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vip6.html">fortios_firewall_vip6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vip64.html">fortios_firewall_vip64</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vipgrp.html">fortios_firewall_vipgrp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vipgrp46.html">fortios_firewall_vipgrp46</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vipgrp6.html">fortios_firewall_vipgrp6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_vipgrp64.html">fortios_firewall_vipgrp64</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_wildcard_fqdn_custom.html">fortios_firewall_wildcard_fqdn_custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_firewall_wildcard_fqdn_group.html">fortios_firewall_wildcard_fqdn_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ftp_proxy_explicit.html">fortios_ftp_proxy_explicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_icap_profile.html">fortios_icap_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_icap_server.html">fortios_icap_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ips_custom.html">fortios_ips_custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ips_decoder.html">fortios_ips_decoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ips_global.html">fortios_ips_global</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ips_rule.html">fortios_ips_rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ips_rule_settings.html">fortios_ips_rule_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ips_sensor.html">fortios_ips_sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ips_settings.html">fortios_ips_settings</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">fortios_ipv4_policy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#metadata">Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-source-code">Module Source Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.disk_filter.html">fortios_log.disk_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.disk_setting.html">fortios_log.disk_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer2_filter.html">fortios_log.fortianalyzer2_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer2_setting.html">fortios_log.fortianalyzer2_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer3_filter.html">fortios_log.fortianalyzer3_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer3_setting.html">fortios_log.fortianalyzer3_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer_filter.html">fortios_log.fortianalyzer_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer_override_filter.html">fortios_log.fortianalyzer_override_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer_override_setting.html">fortios_log.fortianalyzer_override_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortianalyzer_setting.html">fortios_log.fortianalyzer_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortiguard_filter.html">fortios_log.fortiguard_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortiguard_override_filter.html">fortios_log.fortiguard_override_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortiguard_override_setting.html">fortios_log.fortiguard_override_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.fortiguard_setting.html">fortios_log.fortiguard_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.memory_filter.html">fortios_log.memory_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.memory_global_setting.html">fortios_log.memory_global_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.memory_setting.html">fortios_log.memory_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.null_device_filter.html">fortios_log.null_device_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.null_device_setting.html">fortios_log.null_device_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd2_filter.html">fortios_log.syslogd2_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd2_setting.html">fortios_log.syslogd2_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd3_filter.html">fortios_log.syslogd3_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd3_setting.html">fortios_log.syslogd3_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd4_filter.html">fortios_log.syslogd4_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd4_setting.html">fortios_log.syslogd4_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd_filter.html">fortios_log.syslogd_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd_override_filter.html">fortios_log.syslogd_override_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd_override_setting.html">fortios_log.syslogd_override_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.syslogd_setting.html">fortios_log.syslogd_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.webtrends_filter.html">fortios_log.webtrends_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log.webtrends_setting.html">fortios_log.webtrends_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_custom_field.html">fortios_log_custom_field</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_disk_filter.html">fortios_log_disk_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_disk_setting.html">fortios_log_disk_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_eventfilter.html">fortios_log_eventfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer2_filter.html">fortios_log_fortianalyzer2_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer2_setting.html">fortios_log_fortianalyzer2_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer3_filter.html">fortios_log_fortianalyzer3_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer3_setting.html">fortios_log_fortianalyzer3_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer_filter.html">fortios_log_fortianalyzer_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer_override_filter.html">fortios_log_fortianalyzer_override_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer_override_setting.html">fortios_log_fortianalyzer_override_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortianalyzer_setting.html">fortios_log_fortianalyzer_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortiguard_filter.html">fortios_log_fortiguard_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortiguard_override_filter.html">fortios_log_fortiguard_override_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortiguard_override_setting.html">fortios_log_fortiguard_override_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_fortiguard_setting.html">fortios_log_fortiguard_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_gui_display.html">fortios_log_gui_display</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_memory_filter.html">fortios_log_memory_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_memory_global_setting.html">fortios_log_memory_global_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_memory_setting.html">fortios_log_memory_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_null_device_filter.html">fortios_log_null_device_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_null_device_setting.html">fortios_log_null_device_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_setting.html">fortios_log_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd2_filter.html">fortios_log_syslogd2_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd2_setting.html">fortios_log_syslogd2_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd3_filter.html">fortios_log_syslogd3_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd3_setting.html">fortios_log_syslogd3_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd4_filter.html">fortios_log_syslogd4_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd4_setting.html">fortios_log_syslogd4_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd_filter.html">fortios_log_syslogd_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd_override_filter.html">fortios_log_syslogd_override_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd_override_setting.html">fortios_log_syslogd_override_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_syslogd_setting.html">fortios_log_syslogd_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_threat_weight.html">fortios_log_threat_weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_webtrends_filter.html">fortios_log_webtrends_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_log_webtrends_setting.html">fortios_log_webtrends_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_report_chart.html">fortios_report_chart</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_report_dataset.html">fortios_report_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_report_layout.html">fortios_report_layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_report_setting.html">fortios_report_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_report_style.html">fortios_report_style</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_report_theme.html">fortios_report_theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_access_list.html">fortios_router_access_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_access_list6.html">fortios_router_access_list6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_aspath_list.html">fortios_router_aspath_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_auth_path.html">fortios_router_auth_path</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_bfd.html">fortios_router_bfd</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_bfd6.html">fortios_router_bfd6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_bgp.html">fortios_router_bgp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_community_list.html">fortios_router_community_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_isis.html">fortios_router_isis</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_key_chain.html">fortios_router_key_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_multicast.html">fortios_router_multicast</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_multicast6.html">fortios_router_multicast6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_multicast_flow.html">fortios_router_multicast_flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_ospf.html">fortios_router_ospf</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_ospf6.html">fortios_router_ospf6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_policy.html">fortios_router_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_policy6.html">fortios_router_policy6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_prefix_list.html">fortios_router_prefix_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_prefix_list6.html">fortios_router_prefix_list6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_rip.html">fortios_router_rip</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_ripng.html">fortios_router_ripng</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_setting.html">fortios_router_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_static.html">fortios_router_static</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_router_static6.html">fortios_router_static6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_bwl.html">fortios_spamfilter_bwl</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_bword.html">fortios_spamfilter_bword</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_dnsbl.html">fortios_spamfilter_dnsbl</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_fortishield.html">fortios_spamfilter_fortishield</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_iptrust.html">fortios_spamfilter_iptrust</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_mheader.html">fortios_spamfilter_mheader</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_options.html">fortios_spamfilter_options</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_spamfilter_profile.html">fortios_spamfilter_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_ssh_filter_profile.html">fortios_ssh_filter_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller.qos_dot1p_map.html">fortios_switch_controller.qos_dot1p_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller.qos_ip_dscp_map.html">fortios_switch_controller.qos_ip_dscp_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller.qos_qos_policy.html">fortios_switch_controller.qos_qos_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller.qos_queue_policy.html">fortios_switch_controller.qos_queue_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller.security_policy_802_1X.html">fortios_switch_controller.security_policy_802_1X</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller.security_policy_captive_portal.html">fortios_switch_controller.security_policy_captive_portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_802_1X_settings.html">fortios_switch_controller_802_1X_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_custom_command.html">fortios_switch_controller_custom_command</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_global.html">fortios_switch_controller_global</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_igmp_snooping.html">fortios_switch_controller_igmp_snooping</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_lldp_profile.html">fortios_switch_controller_lldp_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_lldp_settings.html">fortios_switch_controller_lldp_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_mac_sync_settings.html">fortios_switch_controller_mac_sync_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_managed_switch.html">fortios_switch_controller_managed_switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_network_monitor_settings.html">fortios_switch_controller_network_monitor_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_quarantine.html">fortios_switch_controller_quarantine</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_sflow.html">fortios_switch_controller_sflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_storm_control.html">fortios_switch_controller_storm_control</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_stp_settings.html">fortios_switch_controller_stp_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_switch_group.html">fortios_switch_controller_switch_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_switch_interface_tag.html">fortios_switch_controller_switch_interface_tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_switch_log.html">fortios_switch_controller_switch_log</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_switch_profile.html">fortios_switch_controller_switch_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_system.html">fortios_switch_controller_system</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_virtual_port_pool.html">fortios_switch_controller_virtual_port_pool</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_switch_controller_vlan.html">fortios_switch_controller_vlan</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.autoupdate_push_update.html">fortios_system.autoupdate_push_update</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.autoupdate_schedule.html">fortios_system.autoupdate_schedule</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.autoupdate_tunneling.html">fortios_system.autoupdate_tunneling</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.dhcp6_server.html">fortios_system.dhcp6_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.dhcp_server.html">fortios_system.dhcp_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_admin.html">fortios_system.replacemsg_admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_alertmail.html">fortios_system.replacemsg_alertmail</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_auth.html">fortios_system.replacemsg_auth</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_device_detection_portal.html">fortios_system.replacemsg_device_detection_portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_ec.html">fortios_system.replacemsg_ec</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_fortiguard_wf.html">fortios_system.replacemsg_fortiguard_wf</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_ftp.html">fortios_system.replacemsg_ftp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_http.html">fortios_system.replacemsg_http</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_icap.html">fortios_system.replacemsg_icap</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_mail.html">fortios_system.replacemsg_mail</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_nac_quar.html">fortios_system.replacemsg_nac_quar</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_nntp.html">fortios_system.replacemsg_nntp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_spam.html">fortios_system.replacemsg_spam</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_sslvpn.html">fortios_system.replacemsg_sslvpn</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_traffic_quota.html">fortios_system.replacemsg_traffic_quota</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_utm.html">fortios_system.replacemsg_utm</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.replacemsg_webproxy.html">fortios_system.replacemsg_webproxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.snmp_community.html">fortios_system.snmp_community</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.snmp_sysinfo.html">fortios_system.snmp_sysinfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system.snmp_user.html">fortios_system.snmp_user</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_accprofile.html">fortios_system_accprofile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_admin.html">fortios_system_admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_affinity_interrupt.html">fortios_system_affinity_interrupt</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_affinity_packet_redistribution.html">fortios_system_affinity_packet_redistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_alarm.html">fortios_system_alarm</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_alias.html">fortios_system_alias</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_api_user.html">fortios_system_api_user</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_arp_table.html">fortios_system_arp_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_auto_install.html">fortios_system_auto_install</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_auto_script.html">fortios_system_auto_script</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_automation_action.html">fortios_system_automation_action</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_automation_destination.html">fortios_system_automation_destination</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_automation_stitch.html">fortios_system_automation_stitch</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_automation_trigger.html">fortios_system_automation_trigger</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_central_management.html">fortios_system_central_management</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_cluster_sync.html">fortios_system_cluster_sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_console.html">fortios_system_console</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_csf.html">fortios_system_csf</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_custom_language.html">fortios_system_custom_language</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ddns.html">fortios_system_ddns</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_dedicated_mgmt.html">fortios_system_dedicated_mgmt</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_dhcp_server.html">fortios_system_dhcp_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_dns.html">fortios_system_dns</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_dns_server.html">fortios_system_dns_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_dscp_based_priority.html">fortios_system_dscp_based_priority</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_email_server.html">fortios_system_email_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_external_resource.html">fortios_system_external_resource</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_fips_cc.html">fortios_system_fips_cc</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_fm.html">fortios_system_fm</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_fortiguard.html">fortios_system_fortiguard</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_fortimanager.html">fortios_system_fortimanager</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_fortisandbox.html">fortios_system_fortisandbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_fsso_polling.html">fortios_system_fsso_polling</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ftm_push.html">fortios_system_ftm_push</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_geoip_override.html">fortios_system_geoip_override</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_global.html">fortios_system_global</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_gre_tunnel.html">fortios_system_gre_tunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ha.html">fortios_system_ha</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ha_monitor.html">fortios_system_ha_monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_interface.html">fortios_system_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ipip_tunnel.html">fortios_system_ipip_tunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ips_urlfilter_dns.html">fortios_system_ips_urlfilter_dns</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ips_urlfilter_dns6.html">fortios_system_ips_urlfilter_dns6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ipv6_neighbor_cache.html">fortios_system_ipv6_neighbor_cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ipv6_tunnel.html">fortios_system_ipv6_tunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_link_monitor.html">fortios_system_link_monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_mac_address_table.html">fortios_system_mac_address_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_management_tunnel.html">fortios_system_management_tunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_mobile_tunnel.html">fortios_system_mobile_tunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_nat64.html">fortios_system_nat64</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_nd_proxy.html">fortios_system_nd_proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_netflow.html">fortios_system_netflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_network_visibility.html">fortios_system_network_visibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_ntp.html">fortios_system_ntp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_object_tagging.html">fortios_system_object_tagging</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_password_policy.html">fortios_system_password_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_password_policy_guest_admin.html">fortios_system_password_policy_guest_admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_pppoe_interface.html">fortios_system_pppoe_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_probe_response.html">fortios_system_probe_response</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_proxy_arp.html">fortios_system_proxy_arp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_replacemsg_group.html">fortios_system_replacemsg_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_replacemsg_image.html">fortios_system_replacemsg_image</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_resource_limits.html">fortios_system_resource_limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_sdn_connector.html">fortios_system_sdn_connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_session_helper.html">fortios_system_session_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_session_ttl.html">fortios_system_session_ttl</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_settings.html">fortios_system_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_sflow.html">fortios_system_sflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_sit_tunnel.html">fortios_system_sit_tunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_sms_server.html">fortios_system_sms_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_storage.html">fortios_system_storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_switch_interface.html">fortios_system_switch_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_tos_based_priority.html">fortios_system_tos_based_priority</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom.html">fortios_system_vdom</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom_dns.html">fortios_system_vdom_dns</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom_exception.html">fortios_system_vdom_exception</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom_link.html">fortios_system_vdom_link</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom_netflow.html">fortios_system_vdom_netflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom_property.html">fortios_system_vdom_property</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom_radius_server.html">fortios_system_vdom_radius_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vdom_sflow.html">fortios_system_vdom_sflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_virtual_wan_link.html">fortios_system_virtual_wan_link</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_virtual_wire_pair.html">fortios_system_virtual_wire_pair</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_vxlan.html">fortios_system_vxlan</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_wccp.html">fortios_system_wccp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_system_zone.html">fortios_system_zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_adgrp.html">fortios_user_adgrp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_device.html">fortios_user_device</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_device_access_list.html">fortios_user_device_access_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_device_category.html">fortios_user_device_category</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_device_group.html">fortios_user_device_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_domain_controller.html">fortios_user_domain_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_fortitoken.html">fortios_user_fortitoken</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_fsso.html">fortios_user_fsso</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_fsso_polling.html">fortios_user_fsso_polling</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_group.html">fortios_user_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_krb_keytab.html">fortios_user_krb_keytab</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_ldap.html">fortios_user_ldap</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_local.html">fortios_user_local</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_password_policy.html">fortios_user_password_policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_peer.html">fortios_user_peer</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_peergrp.html">fortios_user_peergrp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_quarantine.html">fortios_user_quarantine</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_radius.html">fortios_user_radius</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_security_exempt_list.html">fortios_user_security_exempt_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_setting.html">fortios_user_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_tacacs+.html">fortios_user_tacacs+</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_user_tacacsplus.html">fortios_user_tacacsplus</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_voip_profile.html">fortios_voip_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.certificate_ca.html">fortios_vpn.certificate_ca</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.certificate_crl.html">fortios_vpn.certificate_crl</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.certificate_local.html">fortios_vpn.certificate_local</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.certificate_ocsp_server.html">fortios_vpn.certificate_ocsp_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.certificate_remote.html">fortios_vpn.certificate_remote</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.certificate_setting.html">fortios_vpn.certificate_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_concentrator.html">fortios_vpn.ipsec_concentrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_forticlient.html">fortios_vpn.ipsec_forticlient</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_manualkey.html">fortios_vpn.ipsec_manualkey</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_manualkey_interface.html">fortios_vpn.ipsec_manualkey_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_phase1.html">fortios_vpn.ipsec_phase1</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_phase1_interface.html">fortios_vpn.ipsec_phase1_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_phase2.html">fortios_vpn.ipsec_phase2</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ipsec_phase2_interface.html">fortios_vpn.ipsec_phase2_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ssl.web_host_check_software.html">fortios_vpn.ssl.web_host_check_software</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ssl.web_portal.html">fortios_vpn.ssl.web_portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ssl.web_realm.html">fortios_vpn.ssl.web_realm</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ssl.web_user_bookmark.html">fortios_vpn.ssl.web_user_bookmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ssl.web_user_group_bookmark.html">fortios_vpn.ssl.web_user_group_bookmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn.ssl_settings.html">fortios_vpn.ssl_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_concentrator.html">fortios_vpn_ipsec_concentrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_forticlient.html">fortios_vpn_ipsec_forticlient</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_manualkey.html">fortios_vpn_ipsec_manualkey</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_manualkey_interface.html">fortios_vpn_ipsec_manualkey_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_phase1.html">fortios_vpn_ipsec_phase1</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_phase1_interface.html">fortios_vpn_ipsec_phase1_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_phase2.html">fortios_vpn_ipsec_phase2</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ipsec_phase2_interface.html">fortios_vpn_ipsec_phase2_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_l2tp.html">fortios_vpn_l2tp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_pptp.html">fortios_vpn_pptp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ssl_settings.html">fortios_vpn_ssl_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_vpn_ssl_web_portal.html">fortios_vpn_ssl_web_portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_waf_main_class.html">fortios_waf_main_class</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_waf_profile.html">fortios_waf_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_waf_signature.html">fortios_waf_signature</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_waf_sub_class.html">fortios_waf_sub_class</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wanopt_auth_group.html">fortios_wanopt_auth_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wanopt_cache_service.html">fortios_wanopt_cache_service</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wanopt_content_delivery_network_rule.html">fortios_wanopt_content_delivery_network_rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wanopt_peer.html">fortios_wanopt_peer</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wanopt_profile.html">fortios_wanopt_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wanopt_remote_storage.html">fortios_wanopt_remote_storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wanopt_settings.html">fortios_wanopt_settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_debug_url.html">fortios_web_proxy_debug_url</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_explicit.html">fortios_web_proxy_explicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_forward_server.html">fortios_web_proxy_forward_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_forward_server_group.html">fortios_web_proxy_forward_server_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_global.html">fortios_web_proxy_global</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_profile.html">fortios_web_proxy_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_url_match.html">fortios_web_proxy_url_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_web_proxy_wisp.html">fortios_web_proxy_wisp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter.html">fortios_webfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_content.html">fortios_webfilter_content</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_content_header.html">fortios_webfilter_content_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_fortiguard.html">fortios_webfilter_fortiguard</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_ftgd_local_cat.html">fortios_webfilter_ftgd_local_cat</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_ftgd_local_rating.html">fortios_webfilter_ftgd_local_rating</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_ips_urlfilter_cache_setting.html">fortios_webfilter_ips_urlfilter_cache_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_ips_urlfilter_setting.html">fortios_webfilter_ips_urlfilter_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_ips_urlfilter_setting6.html">fortios_webfilter_ips_urlfilter_setting6</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_override.html">fortios_webfilter_override</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_profile.html">fortios_webfilter_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_search_engine.html">fortios_webfilter_search_engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_webfilter_urlfilter.html">fortios_webfilter_urlfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_anqp_3gpp_cellular.html">fortios_wireless_controller.hotspot20_anqp_3gpp_cellular</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_anqp_ip_address_type.html">fortios_wireless_controller.hotspot20_anqp_ip_address_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_anqp_nai_realm.html">fortios_wireless_controller.hotspot20_anqp_nai_realm</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_anqp_network_auth_type.html">fortios_wireless_controller.hotspot20_anqp_network_auth_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_anqp_roaming_consortium.html">fortios_wireless_controller.hotspot20_anqp_roaming_consortium</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_anqp_venue_name.html">fortios_wireless_controller.hotspot20_anqp_venue_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_h2qp_conn_capability.html">fortios_wireless_controller.hotspot20_h2qp_conn_capability</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_h2qp_operator_name.html">fortios_wireless_controller.hotspot20_h2qp_operator_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_h2qp_osu_provider.html">fortios_wireless_controller.hotspot20_h2qp_osu_provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_h2qp_wan_metric.html">fortios_wireless_controller.hotspot20_h2qp_wan_metric</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_hs_profile.html">fortios_wireless_controller.hotspot20_hs_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_icon.html">fortios_wireless_controller.hotspot20_icon</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller.hotspot20_qos_map.html">fortios_wireless_controller.hotspot20_qos_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_ap_status.html">fortios_wireless_controller_ap_status</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_ble_profile.html">fortios_wireless_controller_ble_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_bonjour_profile.html">fortios_wireless_controller_bonjour_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_global.html">fortios_wireless_controller_global</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_inter_controller.html">fortios_wireless_controller_inter_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_qos_profile.html">fortios_wireless_controller_qos_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_setting.html">fortios_wireless_controller_setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_timers.html">fortios_wireless_controller_timers</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_utm_profile.html">fortios_wireless_controller_utm_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_vap.html">fortios_wireless_controller_vap</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_vap_group.html">fortios_wireless_controller_vap_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_wids_profile.html">fortios_wireless_controller_wids_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_wtp.html">fortios_wireless_controller_wtp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_wtp_group.html">fortios_wireless_controller_wtp_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fortios_wireless_controller_wtp_profile.html">fortios_wireless_controller_wtp_profile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fortios_playbooks.html">Playbook Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fsm_root.html">FortiSIEM</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Fortinet Ansible Modules</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../fortios_root.html">FortiGate (FortiOS)</a> &raquo;</li>
        
          <li><a href="../fortios_modules.html">Modules</a> &raquo;</li>
        
      <li>fortios_ipv4_policy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/fortios_modules/fortios_ipv4_policy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fortios-ipv4-policy">
<h1>fortios_ipv4_policy<a class="headerlink" href="#fortios-ipv4-policy" title="Permalink to this headline"></a></h1>
<div class="section" id="metadata">
<h2>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline"></a></h2>
<p><strong>Name:</strong> fortios_ipv4_policy</p>
<p><strong>Description:</strong> This module provides management of firewall IPv4 policies on FortiOS devices.</p>
<p><strong>Author(s):</strong> Benjamin Jolivot (&#64;bjolivot)</p>
<p><strong>Ansible Version Added/Required:</strong> 2.3</p>
<p><strong>Dev Status:</strong> No status updates, yet. Contact Authors.</p>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline"></a></h2>
<div class="section" id="application-list">
<h3>application_list<a class="headerlink" href="#application-list" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies Application Control name.</li>
</ul>
</div>
<div class="section" id="av-profile">
<h3>av_profile<a class="headerlink" href="#av-profile" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies Antivirus profile name.</li>
</ul>
</div>
<div class="section" id="comment">
<h3>comment<a class="headerlink" href="#comment" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: free text to describe policy.</li>
</ul>
</div>
<div class="section" id="dst-addr">
<h3>dst_addr<a class="headerlink" href="#dst-addr" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies destination address (or group) object name(s). Required when I(state=present).</li>
</ul>
</div>
<div class="section" id="dst-addr-negate">
<h3>dst_addr_negate<a class="headerlink" href="#dst-addr-negate" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Negate destination address param.</li>
<li>default: False</li>
</ul>
</div>
<div class="section" id="dst-intf">
<h3>dst_intf<a class="headerlink" href="#dst-intf" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies destination interface name(s).</li>
<li>default: any</li>
</ul>
</div>
<div class="section" id="fixedport">
<h3>fixedport<a class="headerlink" href="#fixedport" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Use fixed port for nat.</li>
<li>default: False</li>
</ul>
</div>
<div class="section" id="id">
<h3>id<a class="headerlink" href="#id" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Policy ID. Warning: policy ID number is different than Policy sequence number. The policy ID is the number assigned at policy creation. The sequence number represents the order in which the Fortigate will evaluate the rule for policy enforcement, and also the order in which rules are listed in the GUI and CLI. These two numbers do not necessarily correlate: this module is based off policy ID. TIP: policy ID can be viewed in the GUI by adding ID to the display columns</li>
<li>Required: True</li>
</ul>
</div>
<div class="section" id="ips-sensor">
<h3>ips_sensor<a class="headerlink" href="#ips-sensor" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies IPS Sensor profile name.</li>
</ul>
</div>
<div class="section" id="logtraffic">
<h3>logtraffic<a class="headerlink" href="#logtraffic" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Logs sessions that matched policy.</li>
<li>default: utm</li>
<li>choices: [disable, utm, all]</li>
</ul>
</div>
<div class="section" id="logtraffic-start">
<h3>logtraffic_start<a class="headerlink" href="#logtraffic-start" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Logs beginning of session as well.</li>
<li>default: False</li>
</ul>
</div>
<div class="section" id="nat">
<h3>nat<a class="headerlink" href="#nat" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Enable or disable Nat.</li>
<li>default: False</li>
</ul>
</div>
<div class="section" id="policy-action">
<h3>policy_action<a class="headerlink" href="#policy-action" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies accept or deny action policy. Required when I(state=present).</li>
<li>choices: [accept, deny]</li>
</ul>
</div>
<div class="section" id="poolname">
<h3>poolname<a class="headerlink" href="#poolname" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies NAT pool name.</li>
</ul>
</div>
<div class="section" id="schedule">
<h3>schedule<a class="headerlink" href="#schedule" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: defines policy schedule.</li>
<li>default: always</li>
</ul>
</div>
<div class="section" id="service">
<h3>service<a class="headerlink" href="#service" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies policy service(s), could be a list (ex: [MAIL,DNS]). Required when I(state=present).</li>
</ul>
</div>
<div class="section" id="service-negate">
<h3>service_negate<a class="headerlink" href="#service-negate" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Negate policy service(s) defined in service value.</li>
<li>default: False</li>
</ul>
</div>
<div class="section" id="src-addr">
<h3>src_addr<a class="headerlink" href="#src-addr" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies source address (or group) object name(s). Required when I(state=present).</li>
</ul>
</div>
<div class="section" id="src-addr-negate">
<h3>src_addr_negate<a class="headerlink" href="#src-addr-negate" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Negate source address param.</li>
<li>default: False</li>
</ul>
</div>
<div class="section" id="src-intf">
<h3>src_intf<a class="headerlink" href="#src-intf" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies source interface name(s).</li>
<li>default: any</li>
</ul>
</div>
<div class="section" id="state">
<h3>state<a class="headerlink" href="#state" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies if policy I(id) need to be added or deleted.</li>
<li>default: present</li>
<li>choices: [present, absent]</li>
</ul>
</div>
<div class="section" id="webfilter-profile">
<h3>webfilter_profile<a class="headerlink" href="#webfilter-profile" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li>Description: Specifies Webfilter profile name.</li>
</ul>
</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li>main</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">comment</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="nb">id</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">src_intf</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">),</span>
        <span class="n">dst_intf</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">),</span>
        <span class="n">state</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;present&#39;</span><span class="p">,</span> <span class="s1">&#39;absent&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;present&#39;</span><span class="p">),</span>
        <span class="n">src_addr</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">),</span>
        <span class="n">dst_addr</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">),</span>
        <span class="n">src_addr_negate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">dst_addr_negate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">policy_action</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accept&#39;</span><span class="p">,</span> <span class="s1">&#39;deny&#39;</span><span class="p">],</span> <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]),</span>
        <span class="n">service</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">),</span>
        <span class="n">service_negate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">schedule</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">),</span>
        <span class="n">nat</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">fixedport</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">poolname</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">av_profile</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">webfilter_profile</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">ips_sensor</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">application_list</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">logtraffic</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;disable&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;utm&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;utm&#39;</span><span class="p">),</span>
        <span class="n">logtraffic_start</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># merge global required_if &amp; argument_spec from module_utils/fortios.py</span>
    <span class="n">argument_spec</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fortios_argument_spec</span><span class="p">)</span>

    <span class="n">ipv4_policy_required_if</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;present&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;src_addr&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_addr&#39;</span><span class="p">,</span> <span class="s1">&#39;policy_action&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">]],</span>
    <span class="p">]</span>

    <span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span>
        <span class="n">argument_spec</span><span class="o">=</span><span class="n">argument_spec</span><span class="p">,</span>
        <span class="n">supports_check_mode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">required_if</span><span class="o">=</span><span class="n">fortios_required_if</span> <span class="o">+</span> <span class="n">ipv4_policy_required_if</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># init forti object</span>
    <span class="n">fortigate</span> <span class="o">=</span> <span class="n">AnsibleFortios</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

    <span class="c1"># Security policies root path</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="s1">&#39;firewall policy&#39;</span>

    <span class="c1"># test params</span>
    <span class="c1"># NAT related</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;nat&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;poolname&#39;</span><span class="p">]:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Poolname param requires NAT to be true.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;fixedport&#39;</span><span class="p">]:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Fixedport param requires NAT to be true.&#39;</span><span class="p">)</span>

    <span class="c1"># log options</span>
    <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic_start&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Logtraffic_start param requires logtraffic to be set to &quot;all&quot;.&#39;</span><span class="p">)</span>

    <span class="c1"># id must be str(int) for pyFG to work</span>
    <span class="n">policy_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

    <span class="c1"># load config</span>
    <span class="n">fortigate</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

    <span class="c1"># Absent State</span>
    <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;absent&#39;</span><span class="p">:</span>
        <span class="n">fortigate</span><span class="o">.</span><span class="n">candidate_config</span><span class="p">[</span><span class="n">config_path</span><span class="p">]</span><span class="o">.</span><span class="n">del_block</span><span class="p">(</span><span class="n">policy_id</span><span class="p">)</span>

    <span class="c1"># Present state</span>
    <span class="k">elif</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;present&#39;</span><span class="p">:</span>
        <span class="n">new_policy</span> <span class="o">=</span> <span class="n">fortigate</span><span class="o">.</span><span class="n">get_empty_configuration_block</span><span class="p">(</span><span class="n">policy_id</span><span class="p">,</span> <span class="s1">&#39;edit&#39;</span><span class="p">)</span>

        <span class="c1"># src / dest / service / interfaces</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;srcintf&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;src_intf&#39;</span><span class="p">]))</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;dstintf&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dst_intf&#39;</span><span class="p">]))</span>

        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;srcaddr&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;src_addr&#39;</span><span class="p">]))</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;dstaddr&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dst_addr&#39;</span><span class="p">]))</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;service&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]))</span>

        <span class="c1"># negate src / dest / service</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;src_addr_negate&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;srcaddr-negate&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dst_addr_negate&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;dstaddr-negate&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;service_negate&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;service-negate&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>

        <span class="c1"># action</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;policy_action&#39;</span><span class="p">]))</span>

        <span class="c1"># logging</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic_start&#39;</span><span class="p">]:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;logtraffic-start&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;logtraffic-start&#39;</span><span class="p">,</span> <span class="s1">&#39;disable&#39;</span><span class="p">)</span>

        <span class="c1"># Schedule</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;schedule&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">]))</span>

        <span class="c1"># NAT</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;nat&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;nat&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;fixedport&#39;</span><span class="p">]:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;fixedport&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;poolname&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;ippool&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;poolname&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;poolname&#39;</span><span class="p">]))</span>

        <span class="c1"># security profiles:</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;av_profile&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;av-profile&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;av_profile&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;webfilter_profile&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;webfilter-profile&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;webfilter_profile&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ips_sensor&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;ips-sensor&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ips_sensor&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;application_list&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;application-list&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;application_list&#39;</span><span class="p">]))</span>

        <span class="c1"># comment</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span>

        <span class="c1"># add the new policy to the device</span>
        <span class="n">fortigate</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">policy_id</span><span class="p">,</span> <span class="n">new_policy</span><span class="p">)</span>

    <span class="c1"># Apply changes</span>
    <span class="n">fortigate</span><span class="o">.</span><span class="n">apply_changes</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="module-source-code">
<h2>Module Source Code<a class="headerlink" href="#module-source-code" title="Permalink to this headline"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1">#</span>
<span class="c1"># Ansible module to manage IPv4 policy objects in fortigate devices</span>
<span class="c1"># (c) 2017, Benjamin Jolivot &lt;bjolivot@gmail.com&gt;</span>
<span class="c1"># GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="vm">__metaclass__</span> <span class="o">=</span> <span class="nb">type</span>


<span class="n">ANSIBLE_METADATA</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;metadata_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.1&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;preview&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;supported_by&#39;</span><span class="p">:</span> <span class="s1">&#39;community&#39;</span><span class="p">}</span>


<span class="n">DOCUMENTATION</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">---</span>
<span class="s2">module: fortios_ipv4_policy</span>
<span class="s2">version_added: &quot;2.3&quot;</span>
<span class="s2">author: &quot;Benjamin Jolivot (@bjolivot)&quot;</span>
<span class="s2">short_description: Manage IPv4 policy objects on Fortinet FortiOS firewall devices</span>
<span class="s2">description:</span>
<span class="s2">  - This module provides management of firewall IPv4 policies on FortiOS devices.</span>
<span class="s2">extends_documentation_fragment: fortios</span>
<span class="s2">options:</span>
<span class="s2">  id:</span>
<span class="s2">    description:</span>
<span class="s2">      - &quot;Policy ID.</span>
<span class="s2">        Warning: policy ID number is different than Policy sequence number.</span>
<span class="s2">        The policy ID is the number assigned at policy creation.</span>
<span class="s2">        The sequence number represents the order in which the Fortigate will evaluate the rule for policy enforcement,</span>
<span class="s2">        and also the order in which rules are listed in the GUI and CLI.</span>
<span class="s2">        These two numbers do not necessarily correlate: this module is based off policy ID.</span>
<span class="s2">        TIP: policy ID can be viewed in the GUI by adding &#39;ID&#39; to the display columns&quot;</span>
<span class="s2">    required: true</span>
<span class="s2">  state:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies if policy I(id) need to be added or deleted.</span>
<span class="s2">    choices: [&#39;present&#39;, &#39;absent&#39;]</span>
<span class="s2">    default: present</span>
<span class="s2">  src_intf:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies source interface name(s).</span>
<span class="s2">    default: any</span>
<span class="s2">  dst_intf:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies destination interface name(s).</span>
<span class="s2">    default: any</span>
<span class="s2">  src_addr:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies source address (or group) object name(s). Required when I(state=present).</span>
<span class="s2">  src_addr_negate:</span>
<span class="s2">    description:</span>
<span class="s2">      - Negate source address param.</span>
<span class="s2">    default: false</span>
<span class="s2">    type: bool</span>
<span class="s2">  dst_addr:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies destination address (or group) object name(s). Required when I(state=present).</span>
<span class="s2">  dst_addr_negate:</span>
<span class="s2">    description:</span>
<span class="s2">      - Negate destination address param.</span>
<span class="s2">    default: false</span>
<span class="s2">    type: bool</span>
<span class="s2">  policy_action:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies accept or deny action policy. Required when I(state=present).</span>
<span class="s2">    choices: [&#39;accept&#39;, &#39;deny&#39;]</span>
<span class="s2">    aliases: [&#39;action&#39;]</span>
<span class="s2">  service:</span>
<span class="s2">    description:</span>
<span class="s2">      - &quot;Specifies policy service(s), could be a list (ex: [&#39;MAIL&#39;,&#39;DNS&#39;]). Required when I(state=present).&quot;</span>
<span class="s2">    aliases:</span>
<span class="s2">      - services</span>
<span class="s2">  service_negate:</span>
<span class="s2">    description:</span>
<span class="s2">      - Negate policy service(s) defined in service value.</span>
<span class="s2">    default: false</span>
<span class="s2">    type: bool</span>
<span class="s2">  schedule:</span>
<span class="s2">    description:</span>
<span class="s2">      - defines policy schedule.</span>
<span class="s2">    default: &#39;always&#39;</span>
<span class="s2">  nat:</span>
<span class="s2">    description:</span>
<span class="s2">      - Enable or disable Nat.</span>
<span class="s2">    default: false</span>
<span class="s2">    type: bool</span>
<span class="s2">  fixedport:</span>
<span class="s2">    description:</span>
<span class="s2">      - Use fixed port for nat.</span>
<span class="s2">    default: false</span>
<span class="s2">    type: bool</span>
<span class="s2">  poolname:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies NAT pool name.</span>
<span class="s2">  av_profile:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies Antivirus profile name.</span>
<span class="s2">  webfilter_profile:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies Webfilter profile name.</span>
<span class="s2">  ips_sensor:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies IPS Sensor profile name.</span>
<span class="s2">  application_list:</span>
<span class="s2">    description:</span>
<span class="s2">      - Specifies Application Control name.</span>
<span class="s2">  logtraffic:</span>
<span class="s2">    version_added: &quot;2.4&quot;</span>
<span class="s2">    description:</span>
<span class="s2">      - Logs sessions that matched policy.</span>
<span class="s2">    default: utm</span>
<span class="s2">    choices: [&#39;disable&#39;, &#39;utm&#39;, &#39;all&#39;]</span>
<span class="s2">  logtraffic_start:</span>
<span class="s2">    version_added: &quot;2.4&quot;</span>
<span class="s2">    description:</span>
<span class="s2">      - Logs beginning of session as well.</span>
<span class="s2">    default: false</span>
<span class="s2">    type: bool</span>
<span class="s2">  comment:</span>
<span class="s2">    description:</span>
<span class="s2">      - free text to describe policy.</span>
<span class="s2">requirements:</span>
<span class="s2">  - pyFG</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">EXAMPLES</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">- name: Allow external DNS call</span>
<span class="s2">  fortios_ipv4_policy:</span>
<span class="s2">    host: 192.168.0.254</span>
<span class="s2">    username: admin</span>
<span class="s2">    password: password</span>
<span class="s2">    id: 42</span>
<span class="s2">    src_addr: internal_network</span>
<span class="s2">    dst_addr: all</span>
<span class="s2">    service: dns</span>
<span class="s2">    nat: True</span>
<span class="s2">    state: present</span>
<span class="s2">    policy_action: accept</span>
<span class="s2">    logtraffic: disable</span>

<span class="s2">- name: Public Web</span>
<span class="s2">  fortios_ipv4_policy:</span>
<span class="s2">    host: 192.168.0.254</span>
<span class="s2">    username: admin</span>
<span class="s2">    password: password</span>
<span class="s2">    id: 42</span>
<span class="s2">    src_addr: all</span>
<span class="s2">    dst_addr: webservers</span>
<span class="s2">    services:</span>
<span class="s2">      - http</span>
<span class="s2">      - https</span>
<span class="s2">    state: present</span>
<span class="s2">    policy_action: accept</span>

<span class="s2">- name: Some Policy</span>
<span class="s2">  fortios_ipv4_policy:</span>
<span class="s2">    host: 192.168.0.254</span>
<span class="s2">    username: admin</span>
<span class="s2">    password: password</span>
<span class="s2">    id: 42</span>
<span class="s2">    comment: &quot;no comment (created by ansible)&quot;</span>
<span class="s2">    src_intf: vl1000</span>
<span class="s2">    src_addr:</span>
<span class="s2">      - some_serverA</span>
<span class="s2">      - some_serverB</span>
<span class="s2">    dst_intf:</span>
<span class="s2">      - vl2000</span>
<span class="s2">      - vl3000</span>
<span class="s2">    dst_addr: all</span>
<span class="s2">    services:</span>
<span class="s2">      - HTTP</span>
<span class="s2">      - HTTPS</span>
<span class="s2">    nat: True</span>
<span class="s2">    state: present</span>
<span class="s2">    policy_action: accept</span>
<span class="s2">    logtraffic: disable</span>
<span class="s2">  tags:</span>
<span class="s2">    - policy</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">RETURN</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">firewall_address_config:</span>
<span class="s2">  description: full firewall addresses config string</span>
<span class="s2">  returned: always</span>
<span class="s2">  type: str</span>
<span class="s2">change_string:</span>
<span class="s2">  description: The commands executed by the module</span>
<span class="s2">  returned: only if config changed</span>
<span class="s2">  type: str</span>
<span class="s2">msg_error_list:</span>
<span class="s2">  description: &quot;List of errors returned by CLI (use -vvv for better readability).&quot;</span>
<span class="s2">  returned: only when error</span>
<span class="s2">  type: str</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">ansible.module_utils.basic</span> <span class="kn">import</span> <span class="n">AnsibleModule</span>
<span class="kn">from</span> <span class="nn">ansible.module_utils.network.fortios.fortios</span> <span class="kn">import</span> <span class="n">fortios_argument_spec</span><span class="p">,</span> <span class="n">fortios_required_if</span>
<span class="kn">from</span> <span class="nn">ansible.module_utils.network.fortios.fortios</span> <span class="kn">import</span> <span class="n">backup</span><span class="p">,</span> <span class="n">AnsibleFortios</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">comment</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="nb">id</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">src_intf</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">),</span>
        <span class="n">dst_intf</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">),</span>
        <span class="n">state</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;present&#39;</span><span class="p">,</span> <span class="s1">&#39;absent&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;present&#39;</span><span class="p">),</span>
        <span class="n">src_addr</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">),</span>
        <span class="n">dst_addr</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">),</span>
        <span class="n">src_addr_negate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">dst_addr_negate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">policy_action</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accept&#39;</span><span class="p">,</span> <span class="s1">&#39;deny&#39;</span><span class="p">],</span> <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]),</span>
        <span class="n">service</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">),</span>
        <span class="n">service_negate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">schedule</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">),</span>
        <span class="n">nat</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">fixedport</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">poolname</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">av_profile</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">webfilter_profile</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">ips_sensor</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">application_list</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="n">logtraffic</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;disable&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;utm&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;utm&#39;</span><span class="p">),</span>
        <span class="n">logtraffic_start</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># merge global required_if &amp; argument_spec from module_utils/fortios.py</span>
    <span class="n">argument_spec</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fortios_argument_spec</span><span class="p">)</span>

    <span class="n">ipv4_policy_required_if</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;present&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;src_addr&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_addr&#39;</span><span class="p">,</span> <span class="s1">&#39;policy_action&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">]],</span>
    <span class="p">]</span>

    <span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span>
        <span class="n">argument_spec</span><span class="o">=</span><span class="n">argument_spec</span><span class="p">,</span>
        <span class="n">supports_check_mode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">required_if</span><span class="o">=</span><span class="n">fortios_required_if</span> <span class="o">+</span> <span class="n">ipv4_policy_required_if</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># init forti object</span>
    <span class="n">fortigate</span> <span class="o">=</span> <span class="n">AnsibleFortios</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

    <span class="c1"># Security policies root path</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="s1">&#39;firewall policy&#39;</span>

    <span class="c1"># test params</span>
    <span class="c1"># NAT related</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;nat&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;poolname&#39;</span><span class="p">]:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Poolname param requires NAT to be true.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;fixedport&#39;</span><span class="p">]:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Fixedport param requires NAT to be true.&#39;</span><span class="p">)</span>

    <span class="c1"># log options</span>
    <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic_start&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Logtraffic_start param requires logtraffic to be set to &quot;all&quot;.&#39;</span><span class="p">)</span>

    <span class="c1"># id must be str(int) for pyFG to work</span>
    <span class="n">policy_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

    <span class="c1"># load config</span>
    <span class="n">fortigate</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

    <span class="c1"># Absent State</span>
    <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;absent&#39;</span><span class="p">:</span>
        <span class="n">fortigate</span><span class="o">.</span><span class="n">candidate_config</span><span class="p">[</span><span class="n">config_path</span><span class="p">]</span><span class="o">.</span><span class="n">del_block</span><span class="p">(</span><span class="n">policy_id</span><span class="p">)</span>

    <span class="c1"># Present state</span>
    <span class="k">elif</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;present&#39;</span><span class="p">:</span>
        <span class="n">new_policy</span> <span class="o">=</span> <span class="n">fortigate</span><span class="o">.</span><span class="n">get_empty_configuration_block</span><span class="p">(</span><span class="n">policy_id</span><span class="p">,</span> <span class="s1">&#39;edit&#39;</span><span class="p">)</span>

        <span class="c1"># src / dest / service / interfaces</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;srcintf&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;src_intf&#39;</span><span class="p">]))</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;dstintf&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dst_intf&#39;</span><span class="p">]))</span>

        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;srcaddr&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;src_addr&#39;</span><span class="p">]))</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;dstaddr&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dst_addr&#39;</span><span class="p">]))</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;service&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]))</span>

        <span class="c1"># negate src / dest / service</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;src_addr_negate&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;srcaddr-negate&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dst_addr_negate&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;dstaddr-negate&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;service_negate&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;service-negate&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>

        <span class="c1"># action</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;policy_action&#39;</span><span class="p">]))</span>

        <span class="c1"># logging</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;logtraffic_start&#39;</span><span class="p">]:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;logtraffic-start&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;logtraffic-start&#39;</span><span class="p">,</span> <span class="s1">&#39;disable&#39;</span><span class="p">)</span>

        <span class="c1"># Schedule</span>
        <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;schedule&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">]))</span>

        <span class="c1"># NAT</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;nat&#39;</span><span class="p">]:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;nat&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;fixedport&#39;</span><span class="p">]:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;fixedport&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;poolname&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;ippool&#39;</span><span class="p">,</span> <span class="s1">&#39;enable&#39;</span><span class="p">)</span>
                <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;poolname&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;poolname&#39;</span><span class="p">]))</span>

        <span class="c1"># security profiles:</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;av_profile&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;av-profile&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;av_profile&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;webfilter_profile&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;webfilter-profile&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;webfilter_profile&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ips_sensor&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;ips-sensor&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ips_sensor&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;application_list&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;application-list&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;application_list&#39;</span><span class="p">]))</span>

        <span class="c1"># comment</span>
        <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">new_policy</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span>

        <span class="c1"># add the new policy to the device</span>
        <span class="n">fortigate</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">policy_id</span><span class="p">,</span> <span class="n">new_policy</span><span class="p">)</span>

    <span class="c1"># Apply changes</span>
    <span class="n">fortigate</span><span class="o">.</span><span class="n">apply_changes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fortios_log.disk_filter.html" class="btn btn-neutral float-right" title="fortios_log.disk_filter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fortios_ips_settings.html" class="btn btn-neutral" title="fortios_ips_settings" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Fortinet, CSE - DevOps

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>